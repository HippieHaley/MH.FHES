<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />  
    <style>
        /* Basic Reset */
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        /* General Body Style */
        body {
          font-family: Arial, sans-serif;
          max-width: 1500px;
          margin: 0 auto;
          background-color: #acdbf9; /* Light blue background */
          color: #333;
          padding-top: 50px;
        }
        /* Back Home Button */
        .back-home {
          display: inline-block;
          padding: 12px 24px;
          background-color: #f8c9f9;
          color: #333;
          text-decoration: none;
          font-size: 1rem;
          font-weight: bold;
          border-radius: 20px;
          text-align: center;
          border: 1px solid #000;
          top: 20px;
          left: 20px;
          z-index: 999; /* Ensures it stays above other elements */
          transition: background-color 0.2s ease;
          position: absolute;
        }
        .back-home:hover {
          background-color: #e8b3e8;
        }
    
        /* Container for Left-Aligned Layout */
        .container {
          width: 100%;
          max-width: 1500px;
          background-color: #acdbf9; /* Light blue background */
          border-radius: 10px;
          padding: 20px;
          box-shadow: 0 0 10px rgba(233, 208, 218, 0.1); /* Optional shadow */
        }
        /* Left Side - Price Sheet (2/3 of the screen) */
        .left-side {
          flex: 1;
          padding-right: 20px;
          margin-right: 35%; /* Pushes content left to make space for .right-side */
        }
        /* Right Side - Itemized List and Grand Total (Fixed Position) */
        .right-side {
          width: 30%;
          padding: 20px;
          border-radius: 10px;
          background-color: #f8c9f9;
          text-align: left;
          font-size: 1rem;
          color: #333;
          position: fixed;
          top: 20px;
          right: 10px;
        }
    
        /* Price Button Styling */
        .price-button {
          display: inline-block;
          padding: 0.5rem 1.5rem;
          background-color: #f8c9f9;
          border: 1px solid #000;
          border-radius: 20px;
          text-decoration: none;
          color: #333;
          font-weight: bold;
          font-size: 1rem;
          cursor: pointer;
          margin: 5px;
        }
        .price-button:hover {
          background-color: #e8b8e8; /* Slightly darker pink */
        }
                  .block-group {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-bottom: 20px;
                flex: 1;
          padding-right: 30px;
          margin-right: 30%; /* Pushes content left to make space for .right-side */
    }
    .block-group h3 {
      margin-bottom: 8px;
      font-size: 1rem;
      font-weight: bold;
      background: #f8c9f9;
      padding: 6px;
      border-radius: 4px;
    }
    .code-option {
      margin-bottom: 8px;
    }
    .code-option label {
      display: flex;
      align-items: center;
    }
    .code-option input[type="checkbox"],
    .code-option input[type="radio"] {
      margin-right: 8px;
    }
    .highlight-section {
      font-weight: bold;
      font-size: 0.9rem;
      text-transform: uppercase;
      margin-top: 15px;
      margin-bottom: 8px;
    }
        /* Table Styling */
        table {
          width: 100%;
          border-collapse: collapse;
          background-color: #acdbf9; /* Light blue background */
          border: 2px solid #333;    /* Solid border */
          border-radius: 8px;        /* Rounded corners */
          overflow: hidden;
          margin: 20px 0;
        }
        /* Table Rows */
        tr {
          border: 2px solid #333;
        }
        /* Table Cells */
        th,
        td {
          text-align: center;
          padding: 15px;
          background-color: #acdbf9;
          color: #333;
        }
        /* Table Header */
        th {
          background-color: #f8c9f9;
          font-weight: bold;
          font-size: 1rem;
          cursor: pointer;
          margin: 5px;
        }
        th:first-child,
        td:first-child {
          background-color: #f8c9f9; /* Soft pink */
          font-weight: bold;
        }
        /* CPT Code Styling */
        .cpt-code {
          font-size: 0.8rem;
          color: #333;
          margin-top: 0.3rem;
          display: block;
          font-style: italic;
        }
    
        /* Itemized List Styling */
        .itemized-list {
          margin-bottom: 20px;
          font-size: 1rem;
          background-color: #f8c9f9;
        }
    
 .remove-button {
          background-color: #f8c9f9;
          border: 1px solid #000;
          border-radius: 5px;
          padding: 2px 5px;
          cursor: pointer;
          margin-left: 5px;
          font-weight: bold;
        }
    
        /* Multiple Button Styling */
        .multiple-button {
          background-color:#acdbf9;
          border: 1px solid #000;
          border-radius: 5px;
          padding: 2px 5px;
          cursor: pointer;
          margin-left: 5px;
          font-weight: bold;
        }
        .multiple-button:hover {
          background-color: #f7bdf7;
        }
    
        /* Copy Receipt Button (different from price buttons) */
.copy-button{ 
          margin-top: 10px;
          padding: 0.5rem 1.5rem;
          background-color: #acdbf9;
          border: 1px solid #000;
          border-radius: 20px;
          text-decoration: none;
          color: #333;
          font-weight: bold;
        font-size: 1rem;
        }
            /* The Fee Selector */
            select#percentSelector {
              width: 100%;
              max-width: 300px;
              padding: 10px 15px;
              margin: 10px 0;
              border: 2px solid #f8c9f9; /* Soft pink border */
              border-radius: 30px;       /* Rounded edges */
              background-color: #f8c9f9; /* Soft pink background */
              color: #333;
              font-size: 1rem;
              outline: none;
              transition: background-color 0.3s ease, border-color 0.3s ease;
              text-align: center;
            }
            select#percentSelector:hover {
              background-color: #f0d4f0; /* Slightly lighter pink */
            }
            select#percentSelector:focus {
              border-color: #e8b8e8;
              background-color: #fff;
              box-shadow: 0 0 5px rgba(232, 184, 232, 0.5);
            }
    </style>
</head>
<body>
 <a href="index.html" class="back-home">Back to Home</a>
     <h1>Price Sheet</h1>
     <div style="margin-bottom: 20px;">
        <label for="percentSelector">Select Fee Percentage:</label>
        <select id="percentSelector" onchange="updateVisibleColumn()">
                <option value="100">100%</option>
                <option value="75">75%</option>
                <option value="50">50%</option>
                <option value="25">25%</option>
        </select>
    </div>
    <div class="right-side">
        <h2>Receipt</h2>
        <div id="itemizedList" class="itemized-list">
            <!-- Itemized list of services will appear here -->
        </div>
        <h2>Total</h2>
        <div id="grandTotal">$0.00</div>
        <button onclick="copyReceipt()" class="copy-button">Copy Receipt</button>
    </div>
    <div class="block-group">
        <div>
            <h3>NEW PT/OFFICE</h3>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Limited-New', 170)"> 99202</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Intermediate-New', 240)"> 99203</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Comprehensive-New', 365)"> 99204</label></div>

        </div>
        <div>
            <h3>EST. PT/OFFICE</h3>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Minimal-Established', 51)"> 99211 (RN)</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Limited-Established', 101)"> 99212</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Intermediate-Established', 166)"> 99213</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Comprehensive-Established', 243)"> 99214</label></div>
        </div>
        <div>
            <h3>IE / NEW PT</h3>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Preventive 12-17 New', 306)"> 99384 (12–17)</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Preventive 18-39 New', 296)"> 99385 (18–39)</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Preventive 40-64 New', 343)"> 99386 (40–64)</label></div>
        </div>
        <div>
            <h3>AE / EST. PT</h3>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Preventive 12-17 Established', 262)"> 99394 (12–17)</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Preventive 18-39 Established', 267)"> 99395 (18–39)</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'Preventive 40-64 Established', 285)"> 99396 (40–64)</label></div>
    </div>
    </div>
    <div class="block-group">
        <div>
            <h3>Procedures</h3>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'LIQUID BASED PAP Z12.4 88142', 40)"> LIQUID BASED PAP Z12.4 88142</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'CONV PAP Z12.4 88164', 38)"> CONV PAP Z12.4 88164</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'HPV Z11.51 87624', 35)"> HPV Z11.51 87624</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'PATHOLOGY FEE 88141', 45)"> PATHOLOGY FEE 88141</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'WET MOUNT N898 87210', 28)"> WET MOUNT N898 87210</label>
            </div>
            <div class="code-option">
                <input type="checkbox" id="chl-checkbox" onchange="handleCheckbox(this, 'CHL Z11.3 87491 x1', 25)"> CHL Z11.3 87491
                <button type="button" class="multiple-button" onclick="addMultiple('CHL Z11.3 87491', 25, 2)">x2</button>
                <button type="button" class="multiple-button" onclick="addMultiple('CHL Z11.3 87491', 25, 3)">x3</button>
            </div>
            <div class="code-option">
                <input type="checkbox" onchange="handleCheckbox(this, 'GC Z11.3 87591 x1', 25)"> GC Z11.3 87591
                <button type="button" class="multiple-button" onclick="addMultiple('GC Z11.3 87591', 25, 2)">x2</button>
                <button type="button" class="multiple-button" onclick="addMultiple('GC Z11.3 87591', 25, 3)">x3</button>
            </div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'GENITAL WART TX A63.0', 0)"> GENITAL WART TX A63.0</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'RAPID HIV 211.4/Z578 86703', 0)"> RAPID HIV 211.4/Z578 86703</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'SERUM HIV Z11.4 87389', 0)"> SERUM HIV Z11.4 87389</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'RPR (SYPHILIS) Z11.3 86592', 0)"> RPR (SYPHILIS) Z11.3 86592</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'TPPA (SYPHILIS) Z11.3 86780', 0)"> TPPA (SYPHILIS) Z11.3 86780</label></div>
        <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'HSV PCR', 0)"> HSV PCR</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'HSV SERUM', 0)"> HSV SERUM</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'URINE DIP', 0)"> URINE DIP</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'INJ. FEE (STI TX) Z11.3 96372', 0)"> INJ. FEE (STI TX) Z11.3 96372</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'INJ. FEE (DEPO) Z30.013/Z30.42', 0)"> INJ. FEE (DEPO) Z30.013/Z30.42</label>
            </div>
            <div class="code-option">
                <label><input type="checkbox" onchange="handleCheckbox(this, 'VENIPUNCTURE Z11.3 36415', 0)"> VENIPUNCTURE Z11.3 36415</label>
            </div>
        </div>
        <div>
            <h3>Pregnancy Test</h3>
            <div class="code-option"><label><input type="radio" name="pregnancy" onclick="addToTotal('POS hCG 232.01 81025', 0)"> POS hCG 232.01 81025</label></div>
            <div class="code-option"><label><input type="radio" name="pregnancy" onclick="addToTotal('NEG hCG 232.02 81025', 0)"> NEG hCG 232.02 81025</label></div>
        </div>
        <div>
            <h3>Medication - Initial & Repeat Codes</h3>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'APRI Z30.011 / Z30.41', 0)"> APRI Z30.011 / Z30.41</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'CAMILA Z30.011 / Z30.41', 0)"> CAMILA Z30.011 / Z30.41</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'DEPO Z30.013 / Z30.42', 0)"> DEPO Z30.013 / Z30.42</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'NUVA RING Z30.015 / Z30.44', 0)"> NUVA RING Z30.015 / Z30.44</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'NEXPLANON Z30.017 / (I&R)Z30.46', 0)"> NEXPLANON Z30.017 / (I&R)Z30.46</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'PARAGARD IUD Z30.430 / (I&R)Z30.46', 0)"> PARAGARD IUD Z30.430 / (I&R)Z30.46</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'IMPLANT INSERT Z30.017', 0)"> IMPLANT INSERT Z30.017</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'IMPLANT REMOVAL Z30.46', 0)"> IMPLANT REMOVAL Z30.46</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'DOXYCYCLINE', 0)"> DOXYCYCLINE</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'ROCEPHIN', 0)"> ROCEPHIN</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'BICILLIN', 0)"> BICILLIN</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'AZITHROMYCIN', 0)"> AZITHROMYCIN</label></div>
            <div class="code-option"><label><input type="checkbox" onchange="handleCheckbox(this, 'SUPRAX', 0)"> SUPRAX</label></div>
            
        </div>
    </div>
    <script>
    let grandTotal = 0;
    const selectedItems = {};

    const basePrices = {
      "Limited-New": 170,
      "Intermediate-New": 240,
      "Comprehensive-New": 365,
      "Minimal-Established": 51,
      "Limited-Established": 101,
      "Intermediate-Established": 166,
      "Comprehensive-Established": 243,
      "Preventive 12-17 New": 306,
      "Preventive 18-39 New": 296,
      "Preventive 40-64 Established": 285,
      "Preventive 12-17 Established": 262,
      "Preventive 18-39 Established": 267,
      "Preventive 40-64 Established": 285,
      "LIQUID BASED PAP Z12.4 88142": 40,
      "CONV PAP Z12.4 88164": 38,
      "HPV Z11.51 87624": 35,
      "PATHOLOGY FEE 88141": 45,
      "WET MOUNT N898 87210": 28,
      "CHL Z11.3 87491": 25,
      "GC Z11.3 87591": 25,
      "GENITAL WART TX A63.0": 0,
      "RAPID HIV 211.4/Z578 86703": 0,
      "SERUM HIV Z11.4 87389": 0,
      "RPR (SYPHILIS) Z11.3 86592": 0,
      "TPPA (SYPHILIS) Z11.3 86780": 0,
      "HSV PCR": 0,
      "HSV SERUM": 0,
      "URINE DIP": 0,
      "INJ. FEE (STI TX) Z11.3 96372": 0,
      "INJ. FEE (DEPO) Z30.013/Z30.42": 0,
      "VENIPUNCTURE Z11.3 36415": 0,
      "APRI Z30.011 / Z30.41": 0,
      "CAMILA Z30.011 / Z30.41": 0,
      "DEPO Z30.013 / Z30.42": 0,
      "NUVA RING Z30.015 / Z30.44": 0,
      "NEXPLANON Z30.017 / (I&R)Z30.46": 0,
      "PARAGARD IUD Z30.430 / (I&R)Z30.46": 0,
      "IMPLANT INSERT Z30.017": 0,
      "IMPLANT REMOVAL Z30.46": 0,
      "DOXYCYCLINE": 0,
      "ROCEPHIN": 0,
      "BICILLIN": 0,
      "AZITHROMYCIN": 0,
      "SUPRAX": 0
    };

    // Add this function to handle the "x2", "x3" multiple buttons
    function addMultiple(service, price, quantity) {
      // Remove any existing entry for this service (with or without x1)
      const baseService = service.replace(/\sx\d+$/, "");
      // Remove both "service x1" and "service" from selectedItems if present
      Object.keys(selectedItems).forEach(key => {
        if (key === baseService || key.startsWith(baseService + " x")) {
          const item = selectedItems[key];
          if (item.listItem && item.listItem.parentNode) {
            item.listItem.parentNode.removeChild(item.listItem);
          }
          grandTotal -= item.totalPrice;
          document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
          delete selectedItems[key];
        }
      });
      // Add the new entry with the correct quantity
      const displayService = `${baseService}`;
      const totalPrice = price * quantity;
      const itemizedList = document.getElementById('itemizedList');
      const listItem = document.createElement('div');
      listItem.className = 'list-item';

      const serviceTextSpan = document.createElement('span');
      serviceTextSpan.className = 'service-text';
      serviceTextSpan.textContent = `${displayService} x${quantity}: $${totalPrice.toFixed(2)}`;
      listItem.appendChild(serviceTextSpan);

      const removeButton = document.createElement('button');
      removeButton.textContent = "X";
      removeButton.className = 'remove-button';
      removeButton.onclick = function () {
        itemizedList.removeChild(listItem);
        grandTotal -= totalPrice;
        document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
        delete selectedItems[displayService + " x" + quantity];
        // Uncheck the corresponding checkbox if present
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(cb => {
          if (cb.parentElement && cb.parentElement.textContent.trim().startsWith(baseService)) {
            cb.checked = false;
          }
        });
      };
      listItem.appendChild(removeButton);

      itemizedList.appendChild(listItem);
      selectedItems[displayService + " x" + quantity] = {
        quantity,
        totalPrice,
        span: serviceTextSpan,
        price,
        listItem
      };
      grandTotal += totalPrice;
      document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;

      // Uncheck the checkbox after adding multiple
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      checkboxes.forEach(cb => {
        if (cb.parentElement && cb.parentElement.textContent.trim().startsWith(baseService)) {
          cb.checked = false;
        }
      });
    }

    function getSelectedPercent() {
      return parseFloat(document.getElementById('percentSelector').value) / 100;
    }

    function handleCheckbox(checkbox, service) {
      const percent = getSelectedPercent();
      const price = basePrices[service] * percent;
      if (checkbox.checked) {
        addToTotal(service, price);
      } else {
        // Remove from receipt and update total
        if (selectedItems.hasOwnProperty(service)) {
          const item = selectedItems[service];
          if (item.listItem && item.listItem.parentNode) {
            item.listItem.parentNode.removeChild(item.listItem);
          }
          grandTotal -= item.totalPrice;
          document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
          delete selectedItems[service];
        }
      }
    }

    function isMultipleAllowed(service) {
      const allowedItems = [
        "APRI Z30.011 / Z30.41",
        "CAMILA Z30.011 / Z30.41",
        "DEPO Z30.013 / Z30.42",
        "NUVA RING Z30.015 / Z30.44",
        "NEXPLANON Z30.017 / (I&R)Z30.46",
        "PARAGARD IUD Z30.430 / (I&R)Z30.46",
        "IMPLANT INSERT Z30.017",
        "IMPLANT REMOVAL Z30.46",
        "DOXYCYCLINE",
        "ROCEPHIN",
        "BICILLIN",
        "AZITHROMYCIN",
        "SUPRAX"
      ];
      return allowedItems.some(item => service === item);
    }

    function addToTotal(service, price) {
      if (selectedItems.hasOwnProperty(service)) {
        const existingItem = selectedItems[service];
        existingItem.quantity++;
        existingItem.totalPrice = existingItem.price * existingItem.quantity;
        existingItem.span.textContent = `${service} x${existingItem.quantity}: $${existingItem.totalPrice.toFixed(2)}`;
        grandTotal += price;
        document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
      } else {
        const itemizedList = document.getElementById('itemizedList');
        const listItem = document.createElement('div');
        listItem.className = 'list-item';

        let totalPrice = price;
        let quantity = 1;

        const serviceTextSpan = document.createElement('span');
        serviceTextSpan.className = 'service-text';
        serviceTextSpan.textContent = `${service} x${quantity}: $${totalPrice.toFixed(2)}`;
        listItem.appendChild(serviceTextSpan);

        if (isMultipleAllowed(service)) {
          const multipleButton = document.createElement('button');
          multipleButton.textContent = "Multiple";
          multipleButton.className = 'multiple-button';
          multipleButton.onclick = function () {
            let newQuantity = parseInt(prompt("Enter quantity (1-13):", quantity), 10);
            if (!isNaN(newQuantity) && newQuantity > 0 && newQuantity <= 13) {
              grandTotal -= totalPrice;
              quantity = newQuantity;
              totalPrice = price * quantity;
              grandTotal += totalPrice;
              serviceTextSpan.textContent = `${service} x${quantity}: $${totalPrice.toFixed(2)}`;
              document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
              selectedItems[service] = {
                quantity,
                totalPrice,
                span: serviceTextSpan,
                price,
                listItem
              };
            }
          };
          listItem.appendChild(multipleButton);
        }

        const removeButton = document.createElement('button');
        removeButton.textContent = "X";
        removeButton.className = 'remove-button';
        removeButton.onclick = function () {
          itemizedList.removeChild(listItem);
          grandTotal -= totalPrice;
          document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
          delete selectedItems[service];
          // Uncheck the corresponding checkbox/radio if present
          const checkboxes = document.querySelectorAll('input[type="checkbox"], input[type="radio"]');
          checkboxes.forEach(cb => {
            // Try to match by label text or value
            if (cb.parentElement && cb.parentElement.textContent.trim().startsWith(service)) {
              cb.checked = false;
            }
          });
        };
        listItem.appendChild(removeButton);

        itemizedList.appendChild(listItem);
        selectedItems[service] = {
          quantity,
          totalPrice,
          span: serviceTextSpan,
          price,
          listItem
        };
        grandTotal += totalPrice;
        document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
      }
    }

    function copyReceipt() {
      const listItems = document.querySelectorAll('#itemizedList .list-item');
      let receiptLines = [];
      listItems.forEach(li => {
        let text = li.firstChild.textContent.trim();
        text = text.replace(/\s*\d+%/, "");
        text = text.replace(/\sx1\b/, "");
        receiptLines.push(text);
      });
      const totalText = document.getElementById('grandTotal').innerText;
      const receiptText = `Services:\n${receiptLines.join("\n")}\nTotal: ${totalText}`;
      navigator.clipboard.writeText(receiptText)
        .then(() => alert('Receipt copied to clipboard!'))
        .catch(() => alert('Failed to copy receipt.'));
    }

    function updateVisibleColumn() {
      const selectedPercent = parseFloat(document.getElementById('percentSelector').value) / 100;
      const priceButtons = document.querySelectorAll('.price-button');

      priceButtons.forEach(button => {
        const fullPrice = parseFloat(button.getAttribute('data-price'));
        if (!fullPrice) return;
        const newPrice = (fullPrice * selectedPercent).toFixed(2);
        button.textContent = `$${newPrice}`;
        button.setAttribute('onclick', `addToTotal('${button.getAttribute('data-name')} ${selectedPercent * 100}%', ${newPrice})`);
      });

      const headerCells = document.querySelectorAll('th');
      if (headerCells.length > 1) {
        headerCells[1].textContent = `${selectedPercent * 100}% Fee`;
      }
      updateReceiptPrices();
    }

    function updateReceiptPrices() {
  const percent = getSelectedPercent();
  Object.keys(selectedItems).forEach(service => {
    const item = selectedItems[service];
    item.price = basePrices[service];
    item.totalPrice = item.price * item.quantity * percent;
    item.span.textContent = `${service} x${item.quantity}: $${item.totalPrice.toFixed(2)}`;
  });
  // Update grand total
  grandTotal = Object.values(selectedItems).reduce((sum, item) => sum + item.totalPrice, 0);
  document.getElementById('grandTotal').textContent = `$${grandTotal.toFixed(2)}`;
}

    document.addEventListener('DOMContentLoaded', () => {
      updateVisibleColumn();
    });
    </script>
</body>
</html>