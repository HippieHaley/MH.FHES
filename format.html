<!DOCTYPE html>
<html lang="en">]
    <body>
    <div class="invoice-container">
      <!-- Header Section -->
      <div class="header">
        <h1>Clinic Name</h1>
        <p>123 Clinic Street, City, State, ZIP</p>
        <p>Phone: (123) 456-7890</p>
        <p>Statement Date: <span id="statementDate">3/14/2025</span></p>
        <p>Client Name: <span id="clientName">John Doe</span></p>
        <p>Client Address: <span id="clientAddress">456 Client Ave, City, State, ZIP</span></p>
        <p class="total-payment">Total Payment Amount: <span id="totalPayment">$80.00</span></p>
      </div>
  
      <!-- Table Section -->
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Claim Number</th>
              <th>Service Date</th>
              <th>Procedure</th>
              <th>Units</th>
              <th>Line Total</th>
              <th>Patient Paid</th>
              <th>Insurance Paid</th>
              <th>Adjustments</th>
              <th>Balance</th>
              <th>Payment</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <!-- Rows will be dynamically inserted here -->
          </tbody>
        </table>
      </div>
  
      <!-- Footer Section -->
      <div class="footer">
        <p>Disclaimer: Charges/adjustments made after statement date are not reflected in this statement.</p>
        <p>Please contact our office for any questions or concerns.</p>
      </div>
    </div>
  
    <input type="file" id="fileInput" accept=".xlsx, .xls" />
    <button onclick="exportToExcel()">Export to Excel</button>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
      // Step 2: Load and Parse the Excel File
      document.getElementById('fileInput').addEventListener('change', async (event) => {
        const file = event.target.files[0];
        if (file) {
          try {
            const arrayBuffer = await file.arrayBuffer();
            const workbook = XLSX.read(arrayBuffer, { type: 'array' });
            const worksheet = workbook.Sheets[workbook.SheetNames[0]];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
  
            // Step 3: Convert Excel Data to Table Rows
            const tableData = jsonData.slice(1).map(row => ({
              claimNumber: row[0],
              serviceDate: row[1],
              procedure: row[2],
              units: row[3],
              lineTotal: row[4],
              patientPaid: row[5],
              insurancePaid: row[6],
              adjustments: row[7],
              balance: row[8],
              payment: row[9]
            }));
  
            // Step 4: Populate the Table
            populateTable(tableData);
          } catch (error) {
            console.error('Error processing Excel file:', error);
            alert('Failed to process Excel file. Check the console for details.');
          }
        }
      });
  
      // Function to Populate the Table
      function populateTable(tableData) {
        const tableBody = document.getElementById('tableBody');
        tableBody.innerHTML = ''; // Clear existing rows
  
        tableData.forEach(row => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${row.claimNumber}</td>
            <td>${row.serviceDate}</td>
            <td>${row.procedure}</td>
            <td>${row.units}</td>
            <td>${row.lineTotal}</td>
            <td>${row.patientPaid}</td>
            <td>${row.insurancePaid}</td>
            <td>${row.adjustments}</td>
            <td>${row.balance}</td>
            <td>${row.payment}</td>
          `;
          tableBody.appendChild(tr);
        });
      }
  
      // Step 5: Export the Table to Excel
      function exportToExcel() {
        try {
          const worksheet = XLSX.utils.table_to_sheet(document.querySelector('table'));
          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Invoice');
          XLSX.writeFile(workbook, 'Invoice_Statement.xlsx');
        } catch (error) {
          console.error("Error exporting to Excel:", error);
          alert("Failed to export to Excel. Check the console for details.");
        }
      }
    </script>
  </body>
  </html>